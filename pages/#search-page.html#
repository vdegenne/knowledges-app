<dom-module id="search-page">
  <template>
    <input type="search" value="{{q::keyup}}">

    <template is="dom-repeat" items="{{knowledges}}">
      {{
    </template>
  </template>

  <script>
  class SearchPage extends Polymer.Element
  {
    static get is () { return 'search-page'; }

    static get properties () {
      return {
        q: {
          type: String
        },

        knowledges: {
          type: Array,
          value: function () { return [] }
        }
      }
    }

    static get observers () {
      return [
        '_qChanged(q)'
      ]
    }

    _qChanged (q) {
      this._debouncer = Polymer.Debouncer.debounce(
        this._debouncer,
        Polymer.Async.timeOut.after(2000),
        () => {
          Valentin.request(
            `/knowledges/api/knowledges/search?q=${this.q}`,
            request => {
              let feedback = request.response;

              Valentin.toast(this, feedback.message, feedback.type);
            });
          
        }
      );
      
    }

        
  }

  customElements.define(SearchPage.is, SearchPage);
  </script>
</dom-module>
